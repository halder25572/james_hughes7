// "use client";

// import { useFormContext } from "@/components/FormContext";
// import { StepProgress } from "@/components/StepProgress";
// import { Step1 } from "@/components/steps/Step1";
// import { Step2 } from "@/components/steps/Step2";
// import { Step3 } from "@/components/steps/Step3";
// import { Step4 } from "@/components/steps/Step4";
// import { Step5 } from "@/components/steps/Step5";
// import { Step6 } from "@/components/steps/Step6";
// import { Step7 } from "@/components/steps/Step7";
// import { Step8 } from "@/components/steps/Step8";

// const STEPS: Record<number, React.ReactNode> = {
//   1: <Step1 />,
//   2: <Step2 />,
//   3: <Step3 />,
//   4: <Step4 />,
//   5: <Step5 />,
//   6: <Step6 />,
//   7: <Step7 />,
//   8: <Step8 />,
// };

// export function MultiStepForm() {
//   const { currentStep } = useFormContext();

//   return (
//     <div className="w-full max-w-190 mx-auto px-4 py-8 sm:py-10">
//       {currentStep < 8 && <StepProgress />}
//       {currentStep === 8 && (
//         <div className="mb-5">
//           <div className="flex items-center justify-between mb-3">
//             <span className="text-[13px] font-medium text-muted-foreground tracking-wide">
//               Step 8 of 8
//             </span>
//             <span className="text-[13px] font-semibold text-emerald-600">
//               ✓ Complete!
//             </span>
//           </div>
//           <div className="h-1.5 w-full rounded-full bg-border/70 overflow-hidden">
//             <div className="h-full rounded-full bg-emerald-500 transition-all duration-500" style={{ width: "100%" }} />
//           </div>
//         </div>
//       )}
//       <div key={currentStep}>{STEPS[currentStep]}</div>
//     </div>
//   );
// }

"use client";

import { useFormContext } from "./FormContext";
import { StepProgress } from "./StepProgress";
import { Step1 } from "./steps/Step1";
import { Step2 } from "./steps/Step2";
import { Step3 } from "./steps/Step3";
import Step4 from "./steps/Step4";
import Step5 from "./steps/Step5";
import Step6 from "./steps/Step6";
import Step7 from "./steps/Step7";
import Step8 from "./steps/Step8";

// so each step is freshly rendered when it becomes active
const STEP_COMPONENTS: Record<number, () => React.ReactElement> = {
  1: () => <Step1 />,
  2: () => <Step2 />,
  3: () => <Step3 />,
  4: () => <Step4 />,
  5: () => <Step5 />,
  6: () => <Step6 />,
  7: () => <Step7 />,
  8: () => <Step8 />,
};

export function MultiStepForm() {
  const { currentStep } = useFormContext();
  const StepComponent = STEP_COMPONENTS[currentStep];

  return (
    <div className="w-full max-w-190 mx-auto px-4 py-8 sm:py-10">
      {currentStep < 8 ? (
        <StepProgress />
      ) : (
        <div className="mb-5">
          <div className="flex items-center justify-between mb-3">
            <span className="text-[13px] font-medium text-muted-foreground tracking-wide">
              Step 8 of 8
            </span>
            <span className="text-[13px] font-semibold text-emerald-600">
              ✓ Complete!
            </span>
          </div>
          <div className="h-1.5 w-full rounded-full bg-border/70 overflow-hidden">
            <div
              className="h-full rounded-full bg-emerald-500 transition-all duration-500"
              style={{ width: "100%" }}
            />
          </div>
        </div>
      )}

      {/* key forces a remount + re-animation on every step change */}
      <div key={currentStep}>
        {StepComponent ? <StepComponent /> : null}
      </div>
    </div>
  );
}